package fr.unice.polytech.si3.qgl.iaac.men;

import fr.unice.polytech.si3.qgl.iaac.ReadJSON;

import static fr.unice.polytech.si3.qgl.iaac.EnumJSON.EXPLOIT;
import static fr.unice.polytech.si3.qgl.iaac.EnumReadJSON.*;

/**
 * Created by dev on 17/12/2016.
 */
public class Exploit implements State {

    /**
     *
     *
     *
     */
    @Override
    public void execute(Men men) {
        String tmp = (String) ReadJSON.getContracts().get(0);
        men.setAction(EXPLOIT.toString(tmp));

    }

    /**
     *
     *
     *
     */
    @Override
    public void wait(Men men) {
        men.subBudget((int) ReadJSON.getInformations().get(COST.toString()));

        men.getRessource((String) ReadJSON.getContracts().get(0)).setAmount(men.getRessource((String) ReadJSON.getContracts().get(0)).getAmount() - ReadJSON.getCollect());
        if (men.getRessource(((String) ReadJSON.getContracts().get(0))).getAmount() <= 0) {
            ReadJSON.getContracts().remove(0);
            ReadJSON.getAmount().remove(0);
            CheminRessource.setWayDefine(false);
            TournerRond.init();
            men.setState(new CheminRessource());
        } else {
            men.setState(new TournerRond());
        }

        if (ReadJSON.getContracts().size() == 0)
            men.setState(new StopMen());


    }

}
