package fr.unice.polytech.si3.qgl.iaac.ground;

import fr.unice.polytech.si3.qgl.iaac.carte.Carte;
import fr.unice.polytech.si3.qgl.iaac.Contract;
import fr.unice.polytech.si3.qgl.iaac.Contracts;
import fr.unice.polytech.si3.qgl.iaac.ReadJSON;

/**
 * Created by lehmann on 12/02/17.
 */
public class Exploit implements State {

    private Contract contract;
    private Contracts contracts;

    @Override
    public String execute(Men men, Contracts contracts, Carte carte) {
        this.contracts = contracts;
        contract =  contracts.getContract();
        return men.exploit(contracts.getContract().getName());
    }

    @Override
    public State wait(ReadJSON json) {
        contract.sub(json.getCollect());
        if (contract.isCompleted()) {
            contracts.remove(contract.getName());
            if(contracts.isPrimaryCompleted()){
                return new DefineWaySecond();
            }
            return new DefineWay();
        } else {
            return new DefineWay();
            //return new TounerRond();
        }
    }

}
